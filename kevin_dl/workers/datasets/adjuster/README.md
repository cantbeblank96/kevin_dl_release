# 调整给定数据集中的数据占比

## 通用

```python
Proportion_Adjuster
```



## 构造不平衡分类数据集

### 常见的不平衡策略

- **指数衰减策略（Exponential Decay）：**

类别样本数按照指数下降。定义一个“失衡因子” $0<\gamma<1$（例如 0.1），然后各类别的样本数按照下面公式变化：
$$
N_i = N_{\text{max}} \times \gamma^{\frac{i}{K-1}}
$$

其中 $N_{\text{max}}$ 为样本数最多的类别的样本数，$K$ 为类别数（CIFAR-10 中 $K=10$），$i$ 为类别索引（通常先将类别按照某种顺序排序，比如从易到难或任意顺序）。

- **幂律分布（Power Law）** ：

描述的是某个数量级上的事件频次随着数值的增大而按幂次下降。对于构造不平衡数据集，可以定义这样的关系式，例如对于类别 $i$（按照出现频率排序），其样本数 $N_i$ 可以表示为：

$$
N_i = N_{\text{max}} \times \left(\frac{1}{i}\right)^\alpha
$$


或类似的形式，其中：


- $N_{\text{max}}$ 是样本最多类别的样本数，
- $i$ 是类别的排名（例如，$i=1$ 表示样本数最多的类别），
- $\alpha$ 是一个控制衰减程度的超参数，值越大，不平衡程度越强。

这种方式与 **指数衰减策略** 类似，不同之处在于幂律分布更加贴近某些现实问题中出现的数据分布方式（例如长尾现象）。

- **阶梯式失衡（Step Imbalance）：**
  对部分类别保留全部样本，其它类别仅保留少量样本。比如前 5 类保留全部样本，后 5 类只保留样本的 10%。



| 策略名称           | 描述                                                         | 优点                                                         | 应用场景                                                     |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 指数衰减采样       | 各类别样本数按照指数函数衰减，如 $N_i = N_{\text{max}} \times \gamma^{\frac{i}{K-1}}$，其中 $\gamma$ 是失衡因子。 | **可控性强：** 通过调整失衡因子 $\gamma$ 精确控制不平衡程度。**适应性好：** 能较好地模拟一定程度的长尾分布。 | 需要模拟中等程度长尾分布的场景，适用于对不平衡程度有精确控制需求的实验。 |
| 阶梯式采样         | 预先划分类别（例如前5类和后5类），其中一部分类别保留全部样本，另一部分类别只保留部分样本。 | **直观明确：** 明显区分“平衡类别”和“不平衡类别”，易于分析模型在不同类别上的表现。**实现简单：** 固定采样比例，无需精细调参。 | 在类别之间区分明显，或者需要进行不同类别分组对比分析时使用。 |
| 幂律/Zipf 分布抽样 | 样本数按幂律关系衰减，一般形式如 $N_i = N_{\text{max}} \times \left(\frac{1}{i}\right)^\alpha$，其中 $\alpha$ 控制衰减速度。 | **贴近实际：** 很多真实应用中（如自然语言）存在长尾效应，使用幂律分布能较好地模拟。**灵活性高：** 通过调整 $\alpha$ 可以实现不同不平衡程度。 | 当需要构造具有明显长尾特征的数据集时，特别适用于模拟自然场景中样本分布不均的情况。 |



## 注意事项


- **测试集通常保持平衡：**
  在许多研究中，只有训练集存在失衡问题，而测试集仍旧保持类别平衡，以便更准确地评估模型在各类别上的性能。
- **不同策略的选择：**
  根据研究目标和实验需求，选择合适的不平衡构造策略。如果希望模拟真实世界中长尾分布的情况，建议使用指数衰减方式；如果只是简单的类别欠采样，则可直接使用固定比例。



## 已有实现
